@model ProductDetailDto

@if (Model.ColorOptions.Any())
{
    <div>
        <h5>Color</h5>
        <div class="btn-group" role="group">
            @foreach (var color in Model.ColorOptions)
            {
                var isSelected = color.IsSelected ? "btn-primary" : "btn-outline-primary";
                <button type="button" class="btn btn-sm color-option @isSelected" data-value="@color.ValueId">
                    @color.Value
                </button>
            }
        </div>
    </div>
}

@if (Model.SizeOptions.Any())
{
    <div class="mt-3">
        <h5>Size</h5>
        <div class="btn-group" role="group">
            @foreach (var size in Model.SizeOptions)
            {
                var isSelected = size.IsSelected ? "btn-primary" : "btn-outline-primary";
                var disabledAttr = !size.IsAvailable ? "disabled" : "";
                <button class="size-option btn btn-sm @isSelected" data-value="@size.ValueId" @disabledAttr>@size.Value</button>
            }
        </div>
    </div>
}
@if (Model.FinishOptions.Any())
{
    <div class="mt-4">
        <h5 class="mb-2">Finish</h5>
        <div class="finish-options d-flex flex-wrap gap-3">
            @foreach (var finish in Model.FinishOptions)
            {
                var activeClass = finish.IsSelected ? "border-primary shadow" : "border-secondary";
                var primaryImage = finish.Images.FirstOrDefault(i => i.IsPrimary)?.ImageUrl
                ?? finish.Images.FirstOrDefault()?.ImageUrl
                ?? "/images/no-image.jpg";

                <div class="finish-card border rounded @activeClass p-2 text-center"
                     data-finish-id="@finish.Id"
                     style="width: 150px; cursor: pointer;">
                    <img src="@primaryImage" alt="@finish.Name"
                         style="width: 100%; height: 150px; object-fit: cover;"
                         class="rounded mb-1" />
                    <div class="fw-medium">@finish.Name</div>
                </div>
            }
        </div>
    </div>
}

@if (Model.FabricOptions.Any())
{
    <div class="mt-3">
        <h5>Fabrics</h5>

        <div class="fabric-options d-flex gap-3 mt-3">
            @foreach (var fabric in Model.FabricOptions)
            {
                var activeClass = fabric.IsSelected ? "active btn-success" : "";
                <button class="btn border fabric-button @activeClass"
                        data-fabric-id="@fabric.Id">
                    @fabric.Fabric @(fabric.IsCustom ? $"(+{fabric.CustomPrice:C})" : "")
                </button>
            }
        </div>
    </div>
}


@if (Model.SelectedVariant != null)
{
    <div>
        <p>SKU: @Model.SelectedVariant.Sku</p>
        <p>Variant Price: $@Model.SelectedVariant.PriceAdjustment.ToString("0.00")</p>
        <input type="hidden" id="variantId" value="@Model.SelectedVariant.Id" />
    </div>
}
